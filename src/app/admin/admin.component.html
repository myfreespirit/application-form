<nav class="navbar navbar-default">
	<div class="container-fluid">
		<div class="navbar-header" class="button-group">

			<div *ngIf="!auth.isAuthenticated()">
				<button mat-button mat-raised-button
					class="btn btn-primary btn-margin"
					(click)="auth.login()">
						LOGIN
				</button>
			</div>

			<div *ngIf="auth.isAuthenticated()">
				<button mat-button mat-raised-button
					class="btn btn-primary"
					(click)="getAllRegistrations()">
						GET REGISTRATIONS
						<mat-spinner color="info" diameter="25" [style.display]="displaySpin ? 'inline-flex' : 'none'"></mat-spinner>
				</button>

				<button mat-button mat-raised-button
					class="btn btn-primary"
					(click)="auth.logout()">
						LOGOUT
				</button>
			</div>

		</div>
	</div>
</nav>


<div *ngIf="displayError" class="alert alert-danger">
	Something went wrong. Please check Developer Tools' Console and report back to developer.
</div>


<div *ngIf="auth.isAuthenticated()">
	<mat-tab-group mat-stretch-tabs class="example-stretched-tabs mat-elevation-z4">
		<mat-tab label="{{ tab }} ({{ data[tab]?.length || 0 }})" *ngFor="let tab of displayedTabs">

			<mat-form-field>
			  <input matInput (keyup)="applyFilter($event.target.value, tab)" [(ngModel)]="dataSource[tab].filter" placeholder="Filter">
			</mat-form-field>

			<button mat-button mat-raised-button (click)="export()"	class="btn btn-primary btn-margin" [disabled]="true">EXPORT</button>

			<div class="mat-elevation-z8">
				<table mat-table [dataSource]="dataSource[tab]" matSort multiTemplateDataRows>

					<ng-container matColumnDef="{{ column }}" *ngFor="let column of displayedColumns">
						<th mat-header-cell *matHeaderCellDef mat-sort-header> {{ column }} </th>
						<td mat-cell *matCellDef="let element"> {{ element[column ] }} </td>
					</ng-container>

					<!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
					<ng-container matColumnDef="expandedDetail">
						<td mat-cell *matCellDef="let element" [attr.colspan]="displayedColumns.length">
							<div class="example-element-detail" [@detailExpand]="element.expanded ? 'expanded' : 'collapsed'" [style.height]="element.expanded ? 'unset' : '0 !important'">
								<p class="example-element-description"> {{ element.wallet }} </p>
								<p class="example-element-description"> {{ element.motivation }} </p>
								<div *ngFor="let state of element.states">
									<span class="example-element-description"> {{ state.date | date:'MMM d, y, h:mm a' }} @{{ state.telegram }} {{ state.status }} </span>
								</div>
								<p>
									Move to:
									<button mat-button mat-raised-button class="btn btn-primary btn-margin" *ngFor="let action of getActionButtons(tab)" (click)="moveApplication(tab, element, action)">
										{{ action }}
									</button>
								</p>
							</div>
						</td>
					  </ng-container>

					  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
					  <tr mat-row *matRowDef="let element; columns: displayedColumns;"
							class="example-element-row"
							[class.example-expanded-row]="element.expanded"
							(click)="element.expanded = !element.expanded">
					  </tr>
					  <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
				</table>

				<mat-paginator #paginator[tab] [pageSizeOptions]="[5, 10, 50, 100, 500]"></mat-paginator>
			</div>

		</mat-tab>
	</mat-tab-group>
</div>
